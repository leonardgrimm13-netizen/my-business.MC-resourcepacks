# ============================================================
# py_free_immage_moderation - Vollständige .env.example
# Alle im Code verwendeten Umgebungsvariablen sind hier enthalten.
# ============================================================

# ---------- Debug / dotenv ----------
# 1 = Debug-Ausgaben für .env-Loading
DEBUG=0
# 1 = vorhandene Shell-Variablen durch .env-Werte überschreiben
DOTENV_OVERRIDE=0

# ---------- CLI / Reporting ----------
# Anzahl Frames für animierte Bilder (GIF etc.)
SAMPLE_FRAMES=12
# 1 = alle Scores ausgeben
SCORE_VERBOSE=0
# Max. Score-Schlüssel für Nicht-Sightengine-Ausgaben
SCORE_MAX_KEYS=8
# Sightengine Ausgabe-Modus: compact | full | keys
SIGHTENGINE_SCORE_MODE=compact
# Nur bei SIGHTENGINE_SCORE_MODE=keys relevant (comma-separated)
SIGHTENGINE_SCORE_KEYS=
# Bei compact: stärkste zusätzliche Signale hinzufügen (0 = aus)
SIGHTENGINE_EXTRA_TOPK=0

# ---------- pHash Listen / Verhalten ----------
# Optionaler Pfad zur pHash-Allowlist
PHASH_ALLOWLIST=data/phash_allowlist.txt
# Optionaler Pfad zur pHash-Blocklist
PHASH_BLOCKLIST=data/phash_blocklist.txt

# 1 = pHash-Allowlist Engine deaktivieren
PHASH_ALLOW_DISABLE=0
# 1 = pHash-Blocklist Engine deaktivieren
PHASH_BLOCK_DISABLE=0

# 1 = pHash-Match entscheidet sofort (Allowlist => OK, Blocklist => BLOCK)
SHORT_CIRCUIT_PHASH=1

# ---------- pHash Auto-Learning ----------
# Master-Switch (empfohlen)
PHASH_AUTO_LEARN_ENABLE=0

# Legacy/Back-Compat: wird weiterhin berücksichtigt
PHASH_AUTO_APPEND=0

# 1 = bei OK-Urteil pHash in Allowlist schreiben
PHASH_AUTO_ALLOW_APPEND=1
# 1 = bei BLOCK-Urteil pHash in Blocklist schreiben
PHASH_AUTO_BLOCK_APPEND=1

# Label bei Auto-Learn (Fallback)
PHASH_AUTO_LABEL=ok
# Spezifische Labels
PHASH_AUTO_ALLOW_LABEL=ok
PHASH_AUTO_BLOCK_LABEL=not_ok

# 1 = bei GIFs ersten + letzten Frame lernen (statt nur erster)
PHASH_GIF_LEARN_FIRST_LAST=1

# ---------- OCR ----------
# 1 = OCR Engine aktivieren
OCR_ENABLE=0
# OCR Sprache (z. B. eng, deu, deu+eng)
OCR_LANG=eng
# Optional expliziter Pfad zum tesseract Binary
TESSERACT_CMD=

# ---------- OpenNSFW2 ----------
# 1 = OpenNSFW2 Engine deaktivieren
OPENNSFW2_DISABLE=0

# ---------- NudeNet ----------
# 1 = NudeNet Engine deaktivieren
NUDENET_DISABLE=0

# ---------- YOLO Waffen-Erkennung ----------
# Backend (aktuell im Code: ultralytics)
YOLO_BACKEND=ultralytics
# Optionaler Modellpfad / Gewichte
YOLO_WORLD_MODEL=
YOLO_WEAPON_MODEL=
YOLO_WEAPONS_WEIGHTS=
# Inferenz-Parameter
YOLO_CONF=0.25
YOLO_IOU=0.45
YOLO_DEVICE=

# Entscheidungs-Thresholds (verdict.py)
YOLO_FIREARM_THRESH=0.35
YOLO_FIREARM_TOY_THRESH=0.25
ALLOW_TOY_GUN=0
YOLO_DANGEROUS_KNIFE_THRESH=0.35
YOLO_KNIFE_THRESH=0.65
YOLO_KNIFE_BLOCK_ALL=0

# ---------- OpenAI Moderation ----------
# 1 = OpenAI Engine deaktivieren
OPENAI_DISABLE=1
OPENAI_API_KEY=

# Request/Rate/Retry
OPENAI_MODERATION_MODEL=omni-moderation-latest
OPENAI_REQUEST_TIMEOUT_SEC=20
OPENAI_MIN_INTERVAL_SEC=1.0
OPENAI_MAX_RETRIES=6
OPENAI_BACKOFF_BASE_SEC=1.0
OPENAI_BACKOFF_MAX_SEC=10
OPENAI_MAX_TOTAL_SLEEP_SEC=30

# Bei HTTP 429: retry | skip
OPENAI_429_POLICY=retry
OPENAI_MAX_429_RETRIES=3

# Lokaler Cache
OPENAI_CACHE_ENABLE=1
OPENAI_CACHE_PATH=.cache/openai_moderation_cache.json
OPENAI_CACHE_MAX_ITEMS=2000

# ---------- Sightengine ----------
SIGHTENGINE_USER=
SIGHTENGINE_SECRET=
SIGHTENGINE_MODELS=nudity-2.1,weapon,violence,gore-2.0,offensive-2.0

# Entscheidungs-Thresholds (verdict.py)
SE_FIREARM_THRESH=0.35
SE_BLOCK_ANY_FIREARM=0
SE_VIOLENCE_THRESH=0.30
SE_GORE_THRESH=0.20
SE_OFFENSIVE_THRESH=0.50
SE_KNIFE_THRESH=0.65
SE_KNIFE_BLOCK_ALL=0
SE_KNIFE_CONTEXT_THRESH=0.25

# ---------- Globale Verdict-Logik ----------
# Kommagetrennte Engine-Namen/Aliase, die als "core" gelten
# Beispiel: CORE_ENGINES=phash_allowlist,phash_blocklist,ocr,openai,sightengine
CORE_ENGINES=

# Verhalten bei Fehlern in Core-Engines: ignore | review | block
ENGINE_ERROR_POLICY=review

# Finale Schwellwerte
FINAL_BLOCK_THRESHOLD=0.85
FINAL_REVIEW_THRESHOLD=0.40
